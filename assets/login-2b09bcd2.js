import{a as c}from"./bootstrap.min-0d2201fe.js";const h="https://roomie-lfta.onrender.com",p=localStorage.getItem("userId"),y=localStorage.getItem("token"),E={headers:{Authorization:`Bearer ${y}`}};let m;const i=document.querySelectorAll(".nav-logged"),d=document.querySelectorAll(".nav-unlogged"),v=document.querySelectorAll(".nav-logged-photo");(async()=>{try{const e=`/600/users/${p}`,t=`${h}${e}`,o=await c.get(t,E),r=o.data.photo;v.forEach(n=>n.setAttribute("src",r)),m=o.data,I(),i.forEach(n=>{n.classList.remove("d-none")}),d.forEach(n=>{n.classList.add("d-none")}),console.log("已登入")}catch(e){console.log(e),i.forEach(t=>{t.classList.add("d-none")}),d.forEach(t=>{t.classList.remove("d-none")}),console.log("未登入")}})();function I(){localStorage.setItem("user",JSON.stringify(m))}const g="https://roomie-lfta.onrender.com",L=document.querySelector(".confirmEmail"),l=document.querySelector("#inputEmail"),a=document.querySelector("#inputPassword");async function u(e,t){const o=t.trim();return o===""?(s(e,"請勿空白!"),!1):e===l&&await S(o)?(s(e,"這個帳號尚未註冊過"),!1):(e.parentElement.children[2].style.display="none",!0)}function s(e,t){e.parentElement.children[2].style.display="flex",e.parentElement.children[2].children[0].children[0].textContent=`${t}`}async function S(e){try{const o=(await c.get(g+"/users")).data;let r=!1;return o.filter(f=>f.email===e).length===1||(r=!0),r}catch(t){console.error("Error fetching user information:",t)}}function U(e,t){c.post(g+"/login",{email:`${e}`,password:`${t}`}).then(o=>{a.parentElement.children[2].style.display="none",console.log(o.data);const r=o.data.accessToken,n=o.data.user.id;localStorage.setItem("token",r),localStorage.setItem("userId",n),k()}).catch(o=>{s(a,"會員密碼不正確")})}function k(){setTimeout(()=>{location.href="user.html"},1e3)}L.addEventListener("click",async e=>{u(l,l.value)&&await u(a,a.value)&&U(l.value,a.value)});
