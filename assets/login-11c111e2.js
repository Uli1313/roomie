import{a as s,S as i}from"./bootstrap.min-acd3fe77.js";const p="https://roomie-lfta.onrender.com",y=localStorage.getItem("userId"),v=localStorage.getItem("token"),E={headers:{Authorization:`Bearer ${v}`}};let f;const u=document.querySelectorAll(".nav-logged"),d=document.querySelectorAll(".nav-unlogged"),I=document.querySelectorAll(".nav-logged-photo"),S=document.querySelector(".logout-btn");(async()=>{try{const e=`/600/users/${y}`,t=`${p}${e}`,o=await s.get(t,E),r=o.data.photo;I.forEach(n=>n.setAttribute("src",r)),f=o.data,w(),u.forEach(n=>{n.classList.remove("d-none")}),d.forEach(n=>{n.classList.add("d-none")})}catch(e){console.log(e),u.forEach(t=>{t.classList.add("d-none")}),d.forEach(t=>{t.classList.remove("d-none")})}})();function w(){localStorage.setItem("user",JSON.stringify(f))}S.addEventListener("click",k);function k(){i.fire({icon:"question",title:"確定要登出嗎",showCancelButton:!0,confirmButtonText:"確定",cancelButtonText:"取消"}).then(e=>{e.isConfirmed&&(localStorage.removeItem("userId"),localStorage.removeItem("token"),localStorage.removeItem("user"),i.fire({icon:"success",title:"已登出",timer:1500,showConfirmButton:!1}),setTimeout(()=>{location.href="login.html"},1e3))})}const g="https://roomie-lfta.onrender.com",L=document.querySelector(".confirmEmail"),l=document.querySelector("#inputEmail"),a=document.querySelector("#inputPassword");async function m(e,t){const o=t.trim();return o===""?(c(e,"請勿空白!"),!1):e===l&&await U(o)?(c(e,"這個帳號尚未註冊過"),!1):(e.parentElement.children[2].style.display="none",!0)}function c(e,t){e.parentElement.children[2].style.display="flex",e.parentElement.children[2].children[0].children[0].textContent=`${t}`}async function U(e){try{const o=(await s.get(g+"/users")).data;let r=!1;return o.filter(h=>h.email===e).length===1||(r=!0),r}catch(t){console.error("Error fetching user information:",t)}}function q(e,t){s.post(g+"/login",{email:`${e}`,password:`${t}`}).then(o=>{a.parentElement.children[2].style.display="none",console.log(o.data);const r=o.data.accessToken,n=o.data.user.id;localStorage.setItem("token",r),localStorage.setItem("userId",n),B()}).catch(o=>{c(a,"會員密碼不正確")})}function B(){setTimeout(()=>{location.href="user.html"},1e3)}L.addEventListener("click",async e=>{m(l,l.value)&&await m(a,a.value)&&q(l.value,a.value)});
