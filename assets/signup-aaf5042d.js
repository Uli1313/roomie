import"./bootstrap.min-e773685c.js";import{a as y}from"./axios-28bc18a3.js";import"./transform-18031762.js";const g="https://roomie-lfta.onrender.com",C=document.querySelector(".confirmEmail"),a=document.querySelector("#inputEmail"),d=document.querySelector("#inputPassword"),h=document.querySelector("#inputConfirmPassword"),i=document.querySelector("#rulesChecked"),E=document.querySelector("#inputSecurityCode"),s=document.querySelector(".confirmSecurityCode");let u=[],l=[],f;function m(e,n){const t=n.trim();return t===""?(c(e,"請勿空白!"),!1):e===a&&b(t.split("@"))?(c(e,"請填寫正確信箱!"),!1):(e===d||e===h)&&x(e,t)?(c(e,"請填寫正確密碼!"),!1):(e.parentElement.children[2].style.display="none",t)}function c(e,n){e.parentElement.children[2].style.display="flex",e.parentElement.children[2].children[0].children[0].textContent=`${n}`}function x(e,n){let t=!1;return/^(?!.*\d{6,})(?!.*(.)\1{4,}).{6,12}$/.test(n)||(t=!0),e===h&&n!==u[0]?t=!0:e===d&&t===!1?u.push(n):u=[],t}function b(e){const n=["gmail.com","yahoo.com.tw"];let t=!1;function r(){for(let o=0;o<n.length;o++)if(n[o]===e[1])return!1;return!0}return(e.length!==2||e.some(o=>o==="")||r())&&(t=!0),t}async function S(e){try{const t=(await y.get(g+"/users")).data;let r=!0;return t.forEach(o=>{o.email===e&&(c(a,"這個帳號已經註冊過"),r=!1)}),r}catch(n){return console.error("Error fetching user information:",n),!1}}function k(e){const n=e[0];f=w(5);let t=`使用者:Email:${n}<br/>驗證碼:${f}<br/>Messages:申請註冊roomie會員<br/> `;Email.send({SecureToken:"64af44cb-e8aa-46d2-9138-00053a70aca2",To:`${n}`,From:"roomie0921@gmail.com",Subject:"親愛的會員您好，Roomie客服中心寄送驗證碼來囉~",Body:t}).then(r=>alert("已傳送驗證碼到信箱")).catch(r=>{console.log(r.response)})}function w(e){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t="";for(let r=0;r<e;r++){const o=Math.floor(Math.random()*n.length);t+=n.charAt(o)}return t}function p(e){s.nextElementSibling.style.display="flex",e?(s.nextElementSibling.textContent="註冊成功",s.nextElementSibling.style.color="green"):(s.nextElementSibling.textContent="驗證失敗",s.nextElementSibling.style.color="red")}function v(e){y.post(g+"/users",{email:`${e[0]}`,password:`${e[1]}`,name:"",nickname:"",gender:"",photo:"",contact:{person:["",""],phone:"",email:"",line:""},about:""}).then(n=>{console.log(n.data)}).catch(n=>{console.log(n.response)})}C.addEventListener("click",async e=>{const n=[a,d,h];l=[];for(const t of n)if(t===a){const r=m(t,t.value);typeof m(t,t.value)=="string"&&await S(r)&&l.push(r)}else m(t,t.value)&&l.push(t.value.trim());i.checked?(i.parentElement.children[2].style.display="none",l.push(i.checked)):c(i,"閱讀完請勾選"),l.length===4&&(E.parentElement.style.display="flex",k(l))});s.addEventListener("click",e=>{E.value===f?(p(!0),v(l)):p(!1)});
